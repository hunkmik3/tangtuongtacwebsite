<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tăng View Reels Instagram - Tăng Tương Tác VIP</title>
    <link rel="stylesheet" href="styles.css">
    <script src="config.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-bar-left"></div>
        <div class="top-bar-right">
            <div class="dark-mode-toggle">
                <input type="checkbox" id="darkModeToggle">
                <label for="darkModeToggle">Dark Mode</label>
            </div>
            <div class="user-info">
                <span>Xin Chào, hunkmike111</span>
                <i class="fas fa-user-circle"></i>
            </div>
            <button class="logout-btn">Đăng Xuất</button>
        </div>
    </div>

    <div class="main-container">
        <!-- Left Sidebar -->
        <div class="sidebar">
            <div class="logo-section">
                <div class="logo">
                    <div class="social-icons">
                        <i class="fab fa-snapchat-ghost"></i>
                        <i class="fab fa-facebook"></i>
                        <i class="fab fa-tiktok"></i>
                        <i class="fab fa-pinterest"></i>
                        <i class="fab fa-youtube"></i>
                        <i class="fab fa-instagram"></i>
                    </div>
                </div>
                <h3>Quản Lý Chung</h3>
            </div>

            <nav class="main-nav">
                <a href="index.html" class="nav-item">
                    <i class="fas fa-home"></i>
                    <span>Trang chủ</span>
                </a>
                <a href="account.html" class="nav-item">
                    <i class="fas fa-user"></i>
                    <span>Thông tin tài khoản</span>
                </a>
                <a href="#" class="nav-item">
                    <i class="fas fa-wallet"></i>
                    <span>Nạp Tiền</span>
                </a>
                <a href="#" class="nav-item">
                    <i class="fas fa-headset"></i>
                    <span>Liên Hệ Hỗ Trợ</span>
                </a>
            </nav>

            <div class="service-list">
                <h4>DANH SÁCH DỊCH VỤ</h4>
                <div class="service-category">
                    <div class="service-category-header">
                        <i class="fab fa-instagram"></i>
                        <span>Instagram</span>
                        <i class="fas fa-chevron-down category-toggle"></i>
                    </div>
                    <div class="service-submenu">
                        <div class="service-subitem">
                            <span>Tăng Like Instagram</span>
                        </div>
                        <div class="service-subitem">
                            <span>Tăng Follow Instagram</span>
                        </div>
                        <div class="service-subitem">
                            <span>Tăng Comment Instagram</span>
                        </div>
                        <div class="service-subitem active">
                            <span>Tăng View Reels</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="content-wrapper">
                <div class="service-header">
                    <h1><i class="fab fa-instagram"></i> Tăng View Reels Instagram</h1>
                    <p>Dịch vụ tăng view reels Instagram chất lượng cao, an toàn và bảo mật</p>
                </div>

                <div class="form-section">
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="bulk-toggle" /> Mua nhiều đơn cùng lúc
                        </label>
                    </div>

                    <div class="form-group">
                        <label for="instagram-reels">Link bài viết:</label>
                        <input type="url" id="instagram-reels" placeholder="https://www.instagram.com/p/id/" required>
                    </div>

                    <div class="form-group">
                        <label>Chọn server:</label>
                        <div class="server-options">
                            <div class="server-option">
                                <input type="radio" name="server" id="server1" checked data-rate="10.6">
                                <label for="server1">
                                    <span class="server-name">View Video+REEL+IGTV. 9d 10.6₫ Hoạt động</span>
                                    <div class="server-info">
                                        <span class="server-details">- Tốc độ đạt ngày triệu view 1 ngày. Tốc độ có thể thay đổi Tối thiểu/Tối đa: 100/1tr</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Số lượng:</label>
                        <input type="number" id="quantity" placeholder="Nhập số lượng view cần tăng" value="100" min="1" max="10000">
                    </div>

                    <div class="form-group">
                        <label for="price-per-interaction">Giá Tiền Mỗi Tương Tác:</label>
                        <input type="text" id="price-per-interaction" readonly>
                    </div>

                    <div class="form-group">
                        <label for="estimated-price">Tổng Giá:</label>
                        <input type="text" id="estimated-price" readonly>
                    </div>

                    <div class="form-group">
                        <label for="notes">Ghi chú:</label>
                        <textarea id="notes" placeholder="Nhập ghi chú nếu cần" rows="3"></textarea>
                    </div>

                    <div class="form-group">
                        <button type="submit" class="submit-btn">
                            <i class="fas fa-rocket"></i>
                            Mua
                        </button>
                        <button type="button" class="manage-id-btn">
                            <i class="fas fa-calendar"></i>
                            Quản Lý ID
                        </button>
                    </div>
                </div>

                
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        const API_BASE = window.API_BASE_URL || 'http://localhost:4000';
        async function apiFetch(path, options = {}) {
            const token = localStorage.getItem('auth.token');
            const headers = Object.assign({ 'Content-Type': 'application/json' }, options.headers || {});
            if (token) headers['Authorization'] = `Bearer ${token}`;
            const res = await fetch(`${API_BASE}${path}`, { ...options, headers });
            const data = await res.json().catch(() => ({}));
            if (!res.ok) throw new Error(data?.error || `Lỗi API: ${res.status}`);
            return data;
        }

        async function getServiceIdByName(name) {
            const services = await apiFetch('/api/services');
            const s = services.find(x => x.name.toLowerCase().includes(name.toLowerCase()));
            if (!s) throw new Error('Không tìm thấy dịch vụ phù hợp');
            return s.id;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const buyBtn = document.querySelector('.submit-btn');
            if (buyBtn) {
                buyBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    try {
                        const serviceId = await getServiceIdByName('View');
                        const quantity = parseInt(document.getElementById('quantity').value) || 0;
                        const note = document.getElementById('notes')?.value || '';
                        const order = await apiFetch('/api/orders', {
                            method: 'POST',
                            body: JSON.stringify({ serviceId, quantity, note })
                        });
                        alert('Tạo đơn thành công #' + order.id);
                    } catch (err) {
                        alert(err.message || 'Lỗi tạo đơn');
                    }
                });
            }
        });
        // Khởi tạo tính giá dùng hàm chung
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hydrateInstagramPage === 'function') {
                hydrateInstagramPage();
            }
        });
    </script>
</body>
</html>
